import{t as he,e as G}from"./tslib.db062970.js";import{a as de}from"./index.1c39ec41.js";const le="PARSE_ERROR",pe="INVALID_REQUEST",ye="METHOD_NOT_FOUND",ge="INVALID_PARAMS",X="INTERNAL_ERROR",x="SERVER_ERROR",ve=[-32700,-32600,-32601,-32602,-32603],T={[le]:{code:-32700,message:"Parse error"},[pe]:{code:-32600,message:"Invalid Request"},[ye]:{code:-32601,message:"Method not found"},[ge]:{code:-32602,message:"Invalid params"},[X]:{code:-32603,message:"Internal error"},[x]:{code:-32e3,message:"Server error"}},z=x;function me(r){return ve.includes(r)}function M(r){return Object.keys(T).includes(r)?T[r]:T[z]}function we(r){const e=Object.values(T).find(n=>n.code===r);return e||T[z]}function be(r,e,n){return r.message.includes("getaddrinfo ENOTFOUND")||r.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${e}`):r}var Ee={},g={},j;function Re(){if(j)return g;j=1,Object.defineProperty(g,"__esModule",{value:!0}),g.isBrowserCryptoAvailable=g.getSubtleCrypto=g.getBrowerCrypto=void 0;function r(){return(globalThis==null?void 0:globalThis.crypto)||(globalThis==null?void 0:globalThis.msCrypto)||{}}g.getBrowerCrypto=r;function e(){const c=r();return c.subtle||c.webkitSubtle}g.getSubtleCrypto=e;function n(){return!!r()&&!!e()}return g.isBrowserCryptoAvailable=n,g}var v={},N;function Te(){if(N)return v;N=1,Object.defineProperty(v,"__esModule",{value:!0}),v.isBrowser=v.isNode=v.isReactNative=void 0;function r(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}v.isReactNative=r;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}v.isNode=e;function n(){return!r()&&!e()}return v.isBrowser=n,v}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=he.exports;e.__exportStar(Re(),r),e.__exportStar(Te(),r)})(Ee);function _e(){const r=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return r+e}function Oe(r,e,n){return{id:n||_e(),jsonrpc:"2.0",method:r,params:e}}function nt(r,e){return{id:r,jsonrpc:"2.0",result:e}}function Ae(r,e,n){return{id:r,jsonrpc:"2.0",error:Ce(e,n)}}function Ce(r,e){return typeof r>"u"?M(X):(typeof r=="string"&&(r=Object.assign(Object.assign({},M(x)),{message:r})),typeof e<"u"&&(r.data=e),me(r.code)&&(r=we(r.code)),r)}class Q{}class ot extends Q{constructor(e){super()}}class De extends Q{constructor(){super()}}class Pe extends De{constructor(e){super()}}const Se="^https?:",xe="^wss?:";function Fe(r){const e=r.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function K(r,e){const n=Fe(r);return typeof n>"u"?!1:new RegExp(e).test(n)}function H(r){return K(r,Se)}function st(r){return K(r,xe)}function it(r){return new RegExp("wss?://localhost(:d{2,5})?").test(r)}function Y(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function at(r){return Y(r)&&"method"in r}function Le(r){return Y(r)&&(Be(r)||Z(r))}function Be(r){return"result"in r}function Z(r){return"error"in r}class ct extends Pe{constructor(e){super(e),this.events=new G.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async request(e,n){return this.requestStrict(Oe(e.method,e.params||[]),n)}async requestStrict(e,n){return new Promise(async(c,i)=>{if(!this.connection.connected)try{await this.open()}catch(a){i(a)}this.events.on(`${e.id}`,a=>{Z(a)?i(a.error):c(a.result)});try{await this.connection.send(e,n)}catch(a){i(a)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Le(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}var P={exports:{}};(function(r,e){var n=function(){function i(){this.fetch=!1,this.DOMException=globalThis.DOMException}return i.prototype=globalThis,new i}();(function(i){(function(a){var l={searchParams:"URLSearchParams"in i,iterable:"Symbol"in i&&"iterator"in Symbol,blob:"FileReader"in i&&"Blob"in i&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in i,arrayBuffer:"ArrayBuffer"in i};function F(t){return t&&DataView.prototype.isPrototypeOf(t)}if(l.arrayBuffer)var te=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],re=ArrayBuffer.isView||function(t){return t&&te.indexOf(Object.prototype.toString.call(t))>-1};function E(t){if(typeof t!="string"&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function L(t){return typeof t!="string"&&(t=String(t)),t}function O(t){var o={next:function(){var s=t.shift();return{done:s===void 0,value:s}}};return l.iterable&&(o[Symbol.iterator]=function(){return o}),o}function h(t){this.map={},t instanceof h?t.forEach(function(o,s){this.append(s,o)},this):Array.isArray(t)?t.forEach(function(o){this.append(o[0],o[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(o){this.append(o,t[o])},this)}h.prototype.append=function(t,o){t=E(t),o=L(o);var s=this.map[t];this.map[t]=s?s+", "+o:o},h.prototype.delete=function(t){delete this.map[E(t)]},h.prototype.get=function(t){return t=E(t),this.has(t)?this.map[t]:null},h.prototype.has=function(t){return this.map.hasOwnProperty(E(t))},h.prototype.set=function(t,o){this.map[E(t)]=L(o)},h.prototype.forEach=function(t,o){for(var s in this.map)this.map.hasOwnProperty(s)&&t.call(o,this.map[s],s,this)},h.prototype.keys=function(){var t=[];return this.forEach(function(o,s){t.push(s)}),O(t)},h.prototype.values=function(){var t=[];return this.forEach(function(o){t.push(o)}),O(t)},h.prototype.entries=function(){var t=[];return this.forEach(function(o,s){t.push([s,o])}),O(t)},l.iterable&&(h.prototype[Symbol.iterator]=h.prototype.entries);function A(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function B(t){return new Promise(function(o,s){t.onload=function(){o(t.result)},t.onerror=function(){s(t.error)}})}function ne(t){var o=new FileReader,s=B(o);return o.readAsArrayBuffer(t),s}function oe(t){var o=new FileReader,s=B(o);return o.readAsText(t),s}function se(t){for(var o=new Uint8Array(t),s=new Array(o.length),p=0;p<o.length;p++)s[p]=String.fromCharCode(o[p]);return s.join("")}function U(t){if(t.slice)return t.slice(0);var o=new Uint8Array(t.byteLength);return o.set(new Uint8Array(t)),o.buffer}function I(){return this.bodyUsed=!1,this._initBody=function(t){this._bodyInit=t,t?typeof t=="string"?this._bodyText=t:l.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:l.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:l.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():l.arrayBuffer&&l.blob&&F(t)?(this._bodyArrayBuffer=U(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):l.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||re(t))?this._bodyArrayBuffer=U(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||(typeof t=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):l.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},l.blob&&(this.blob=function(){var t=A(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?A(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ne)}),this.text=function(){var t=A(this);if(t)return t;if(this._bodyBlob)return oe(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(se(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},l.formData&&(this.formData=function(){return this.text().then(ce)}),this.json=function(){return this.text().then(JSON.parse)},this}var ie=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function ae(t){var o=t.toUpperCase();return ie.indexOf(o)>-1?o:t}function m(t,o){o=o||{};var s=o.body;if(t instanceof m){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,o.headers||(this.headers=new h(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,!s&&t._bodyInit!=null&&(s=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=o.credentials||this.credentials||"same-origin",(o.headers||!this.headers)&&(this.headers=new h(o.headers)),this.method=ae(o.method||this.method||"GET"),this.mode=o.mode||this.mode||null,this.signal=o.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&s)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(s)}m.prototype.clone=function(){return new m(this,{body:this._bodyInit})};function ce(t){var o=new FormData;return t.trim().split("&").forEach(function(s){if(s){var p=s.split("="),d=p.shift().replace(/\+/g," "),u=p.join("=").replace(/\+/g," ");o.append(decodeURIComponent(d),decodeURIComponent(u))}}),o}function ue(t){var o=new h,s=t.replace(/\r?\n[\t ]+/g," ");return s.split(/\r?\n/).forEach(function(p){var d=p.split(":"),u=d.shift().trim();if(u){var _=d.join(":").trim();o.append(u,_)}}),o}I.call(m.prototype);function y(t,o){o||(o={}),this.type="default",this.status=o.status===void 0?200:o.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in o?o.statusText:"OK",this.headers=new h(o.headers),this.url=o.url||"",this._initBody(t)}I.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},y.error=function(){var t=new y(null,{status:0,statusText:""});return t.type="error",t};var fe=[301,302,303,307,308];y.redirect=function(t,o){if(fe.indexOf(o)===-1)throw new RangeError("Invalid status code");return new y(null,{status:o,headers:{location:t}})},a.DOMException=i.DOMException;try{new a.DOMException}catch{a.DOMException=function(o,s){this.message=o,this.name=s;var p=Error(o);this.stack=p.stack},a.DOMException.prototype=Object.create(Error.prototype),a.DOMException.prototype.constructor=a.DOMException}function C(t,o){return new Promise(function(s,p){var d=new m(t,o);if(d.signal&&d.signal.aborted)return p(new a.DOMException("Aborted","AbortError"));var u=new XMLHttpRequest;function _(){u.abort()}u.onload=function(){var R={status:u.status,statusText:u.statusText,headers:ue(u.getAllResponseHeaders()||"")};R.url="responseURL"in u?u.responseURL:R.headers.get("X-Request-URL");var D="response"in u?u.response:u.responseText;s(new y(D,R))},u.onerror=function(){p(new TypeError("Network request failed"))},u.ontimeout=function(){p(new TypeError("Network request failed"))},u.onabort=function(){p(new a.DOMException("Aborted","AbortError"))},u.open(d.method,d.url,!0),d.credentials==="include"?u.withCredentials=!0:d.credentials==="omit"&&(u.withCredentials=!1),"responseType"in u&&l.blob&&(u.responseType="blob"),d.headers.forEach(function(R,D){u.setRequestHeader(D,R)}),d.signal&&(d.signal.addEventListener("abort",_),u.onreadystatechange=function(){u.readyState===4&&d.signal.removeEventListener("abort",_)}),u.send(typeof d._bodyInit>"u"?null:d._bodyInit)})}return C.polyfill=!0,i.fetch||(i.fetch=C,i.Headers=h,i.Request=m,i.Response=y),a.Headers=h,a.Request=m,a.Response=y,a.fetch=C,Object.defineProperty(a,"__esModule",{value:!0}),a})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var c=n;e=c.fetch,e.default=c.fetch,e.fetch=c.fetch,e.Headers=c.Headers,e.Request=c.Request,e.Response=c.Response,r.exports=e})(P,P.exports);const q=de(P.exports),Ue=r=>JSON.stringify(r,(e,n)=>typeof n=="bigint"?n.toString()+"n":n),Ie=r=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,n=r.replace(e,'$1"$2n"$3');return JSON.parse(n,(c,i)=>typeof i=="string"&&i.match(/^\d+n$/)?BigInt(i.substring(0,i.length-1)):i)};function Me(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return Ie(r)}catch{return r}}function J(r){return typeof r=="string"?r:Ue(r)||""}const je={Accept:"application/json","Content-Type":"application/json"},Ne="POST",$={headers:je,method:Ne},V=10;class ut{constructor(e){if(this.url=e,this.events=new G.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!H(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,n){this.isAvailable||await this.register();try{const c=J(e),a=await(await q(this.url,Object.assign(Object.assign({},$),{body:c}))).json();this.onPayload({data:a})}catch(c){this.onError(e.id,c)}}async register(e=this.url){if(!H(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((c,i)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),i(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return i(new Error("HTTP connection is missing or invalid"));c()})})}this.url=e,this.registering=!0;try{const n=J({id:1,jsonrpc:"2.0",method:"test",params:[]});await q(e,Object.assign(Object.assign({},$),{body:n})),this.onOpen()}catch(n){const c=this.parseError(n);throw this.events.emit("register_error",c),this.onClose(),c}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?Me(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const c=this.parseError(n),i=c.message||c.toString(),a=Ae(e,i);this.events.emit("payload",a)}parseError(e,n=this.url){return be(e,n,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>V&&this.events.setMaxListeners(V)}}var f={};Object.defineProperty(f,"__esModule",{value:!0});f.getLocalStorage=f.getLocalStorageOrThrow=f.getCrypto=f.getCryptoOrThrow=Xe=f.getLocation=f.getLocationOrThrow=ke=f.getNavigator=f.getNavigatorOrThrow=Je=f.getDocument=f.getDocumentOrThrow=f.getFromWindowOrThrow=f.getFromWindow=void 0;function w(r){let e;return typeof window<"u"&&typeof window[r]<"u"&&(e=window[r]),e}f.getFromWindow=w;function b(r){const e=w(r);if(!e)throw new Error(`${r} is not defined in Window`);return e}f.getFromWindowOrThrow=b;function He(){return b("document")}f.getDocumentOrThrow=He;function qe(){return w("document")}var Je=f.getDocument=qe;function $e(){return b("navigator")}f.getNavigatorOrThrow=$e;function Ve(){return w("navigator")}var ke=f.getNavigator=Ve;function We(){return b("location")}f.getLocationOrThrow=We;function Ge(){return w("location")}var Xe=f.getLocation=Ge;function ze(){return b("crypto")}f.getCryptoOrThrow=ze;function Qe(){return w("crypto")}f.getCrypto=Qe;function Ke(){return b("localStorage")}f.getLocalStorageOrThrow=Ke;function Ye(){return w("localStorage")}f.getLocalStorage=Ye;var ft=r=>encodeURIComponent(r).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),ee="%[a-f0-9]{2}",k=new RegExp("("+ee+")|([^%]+?)","gi"),W=new RegExp("("+ee+")+","gi");function S(r,e){try{return[decodeURIComponent(r.join(""))]}catch{}if(r.length===1)return r;e=e||1;var n=r.slice(0,e),c=r.slice(e);return Array.prototype.concat.call([],S(n),S(c))}function Ze(r){try{return decodeURIComponent(r)}catch{for(var e=r.match(k)||[],n=1;n<e.length;n++)r=S(e,n).join(""),e=r.match(k)||[];return r}}function et(r){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},n=W.exec(r);n;){try{e[n[0]]=decodeURIComponent(n[0])}catch{var c=Ze(n[0]);c!==n[0]&&(e[n[0]]=c)}n=W.exec(r)}e["%C2"]="\uFFFD";for(var i=Object.keys(e),a=0;a<i.length;a++){var l=i[a];r=r.replace(new RegExp(l,"g"),e[l])}return r}var ht=function(r){if(typeof r!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof r+"`");try{return r=r.replace(/\+/g," "),decodeURIComponent(r)}catch{return et(r)}},dt=(r,e)=>{if(!(typeof r=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[r];const n=r.indexOf(e);return n===-1?[r]:[r.slice(0,n),r.slice(n+e.length)]};export{ut as H,ot as I,ct as J,ft as a,Ee as b,f as c,ht as d,J as e,Ae as f,Xe as g,Je as h,ke as i,st as j,it as k,Me as l,be as m,at as n,nt as o,_e as p,Be as q,Z as r,dt as s,Le as t,Oe as u};
